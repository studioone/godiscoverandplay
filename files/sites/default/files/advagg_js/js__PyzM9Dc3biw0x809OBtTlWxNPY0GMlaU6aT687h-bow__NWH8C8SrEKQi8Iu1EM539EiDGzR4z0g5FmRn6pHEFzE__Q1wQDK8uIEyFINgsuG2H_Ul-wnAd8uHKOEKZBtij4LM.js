/* Source and licensing information for the line(s) below can be found at http://godiscoverandplay.com/misc/progress.js. */
(function($){Drupal.progressBar=function(id,updateCallback,method,errorCallback){var pb=this;this.id=id;this.method=method||'GET';this.updateCallback=updateCallback;this.errorCallback=errorCallback;this.element=$('<div class="progress" aria-live="polite"></div>').attr('id',id);this.element.html('<div class="bar"><div class="filled"></div></div><div class="percentage"></div><div class="message">&nbsp;</div>')};Drupal.progressBar.prototype.setProgress=function(percentage,message){if(percentage>=0&&percentage<=100){$('div.filled',this.element).css('width',percentage+'%');$('div.percentage',this.element).html(percentage+'%')};$('div.message',this.element).html(message);if(this.updateCallback)this.updateCallback(percentage,message,this)};Drupal.progressBar.prototype.startMonitoring=function(uri,delay){this.delay=delay;this.uri=uri;this.sendPing()};Drupal.progressBar.prototype.stopMonitoring=function(){clearTimeout(this.timer);this.uri=null};Drupal.progressBar.prototype.sendPing=function(){if(this.timer)clearTimeout(this.timer);if(this.uri){var pb=this;$.ajax({type:this.method,url:this.uri,data:'',dataType:'json',success:function(progress){if(progress.status==0){pb.displayError(progress.data);return};pb.setProgress(progress.percentage,progress.message);pb.timer=setTimeout(function(){pb.sendPing()},pb.delay)},error:function(xmlhttp){pb.displayError(Drupal.ajaxError(xmlhttp,pb.uri))}})}};Drupal.progressBar.prototype.displayError=function(string){var error=$('<div class="messages error"></div>').html(string);$(this.element).before(error).hide();if(this.errorCallback)this.errorCallback(this)}})(jQuery);
/* Source and licensing information for the above line(s) can be found at http://godiscoverandplay.com/misc/progress.js. */
/* Source and licensing information for the line(s) below can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/views/js/base.js. */
(function($){Drupal.Views={};Drupal.behaviors.viewsTabs={attach:function(context){if($.viewsUi&&$.viewsUi.tabs)$('#views-tabset').once('views-processed').viewsTabs({selectedClass:'active'});$('a.views-remove-link').once('views-processed').click(function(event){var id=$(this).attr('id').replace('views-remove-link-','');$('#views-row-'+id).hide();$('#views-removed-'+id).attr('checked',true);event.preventDefault()});$('a.display-remove-link').addClass('display-processed').click(function(){var id=$(this).attr('id').replace('display-remove-link-','');$('#display-row-'+id).hide();$('#display-removed-'+id).attr('checked',true);return false})}};Drupal.Views.parseQueryString=function(query){var args={},pos=query.indexOf('?');if(pos!=-1)query=query.substring(pos+1);var pairs=query.split('&');for(var i in pairs)if(typeof(pairs[i])=='string'){var pair=pairs[i].split('=');if(pair[0]!='q'&&pair[1])args[decodeURIComponent(pair[0].replace(/\+/g,' '))]=decodeURIComponent(pair[1].replace(/\+/g,' '))};return args};Drupal.Views.parseViewArgs=function(href,viewPath){var returnObj={},path=Drupal.Views.getPath(href);if(viewPath&&path.substring(0,viewPath.length+1)==viewPath+'/'){var args=decodeURIComponent(path.substring(viewPath.length+1,path.length));returnObj.view_args=args;returnObj.view_path=path};return returnObj};Drupal.Views.pathPortion=function(href){var protocol=window.location.protocol;if(href.substring(0,protocol.length)==protocol)href=href.substring(href.indexOf('/',protocol.length+2));return href};Drupal.Views.getPath=function(href){href=Drupal.Views.pathPortion(href);href=href.substring(Drupal.settings.basePath.length,href.length);if(href.substring(0,3)=='?q=')href=href.substring(3,href.length);var chars=['#','?','&'];for(i in chars)if(href.indexOf(chars[i])>-1)href=href.substr(0,href.indexOf(chars[i]));return href}})(jQuery);
/* Source and licensing information for the above line(s) can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/views/js/base.js. */
/* Source and licensing information for the line(s) below can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/views/js/ajax_view.js. */
(function($){Drupal.behaviors.ViewsAjaxView={};Drupal.behaviors.ViewsAjaxView.attach=function(){if(Drupal.settings&&Drupal.settings.views&&Drupal.settings.views.ajaxViews)$.each(Drupal.settings.views.ajaxViews,function(i,settings){Drupal.views.instances[i]=new Drupal.views.ajaxView(settings)})};Drupal.views={};Drupal.views.instances={};Drupal.views.ajaxView=function(settings){var selector='.view-dom-id-'+settings.view_dom_id;this.$view=$(selector);var ajax_path=Drupal.settings.views.ajax_path;if(ajax_path.constructor.toString().indexOf("Array")!=-1)ajax_path=ajax_path[0];var queryString=window.location.search||'';if(queryString!==''){var queryString=queryString.slice(1).replace(/q=[^&]+&?|&?render=[^&]+/,'');if(queryString!=='')queryString=((/\?/.test(ajax_path))?'&':'?')+queryString};this.element_settings={url:ajax_path+queryString,submit:settings,setClick:true,event:'click',selector:selector,progress:{type:'throbber'}};this.settings=settings;this.$exposed_form=$('form#views-exposed-form-'+settings.view_name.replace(/_/g,'-')+'-'+settings.view_display_id.replace(/_/g,'-'));this.$exposed_form.once(jQuery.proxy(this.attachExposedFormAjax,this));this.$view.filter(jQuery.proxy(this.filterNestedViews,this)).once(jQuery.proxy(this.attachPagerAjax,this))};Drupal.views.ajaxView.prototype.attachExposedFormAjax=function(){var button=$('input[type=submit], button[type=submit], input[type=image]',this.$exposed_form);button=button[0];this.exposedFormAjax=new Drupal.ajax($(button).attr('id'),button,this.element_settings)};Drupal.views.ajaxView.prototype.filterNestedViews=function(){return!this.$view.parents('.view').size()};Drupal.views.ajaxView.prototype.attachPagerAjax=function(){this.$view.find('ul.pager > li > a, th.views-field a, .attachment .views-summary a').each(jQuery.proxy(this.attachPagerLinkAjax,this))};Drupal.views.ajaxView.prototype.attachPagerLinkAjax=function(id,link){var $link=$(link),viewData={},href=$link.attr('href');$.extend(viewData,this.settings,Drupal.Views.parseQueryString(href),Drupal.Views.parseViewArgs(href,this.settings.view_base_path));$.extend(viewData,Drupal.Views.parseViewArgs(href,this.settings.view_base_path));this.element_settings.submit=viewData;this.pagerAjax=new Drupal.ajax(false,$link,this.element_settings)};Drupal.ajax.prototype.commands.viewsScrollTop=function(ajax,response,status){var offset=$(response.selector).offset(),scrollTarget=response.selector;while($(scrollTarget).scrollTop()==0&&$(scrollTarget).parent())scrollTarget=$(scrollTarget).parent();if(offset.top-10<$(scrollTarget).scrollTop())$(scrollTarget).animate({scrollTop:(offset.top-10)},500)}})(jQuery);
/* Source and licensing information for the above line(s) can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/views/js/ajax_view.js. */
/* Source and licensing information for the line(s) below can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/boxes/boxes.js. */
(function($){Drupal.ajax.prototype.commands['getBlock']=function(ajax,response,status){var box=$(this).parents('.boxes-box');data=response;$.ajax({type:"GET",url:data.url,data:{boxes_delta:data.delta},global:true,success:function(response,status){if($('#boxes-box-form').dialog('isOpen'))$('#boxes-box-form').dialog('close');$('.hasPopup').removeClass('hasPopup');box.removeClass('boxes-box-editing').find('.box-editor').remove().end().find('.boxes-box-content').show();ajax.success(response,status)},error:Drupal.ajax.error,dataType:'json'})};Drupal.ajax.prototype.commands['showBoxForm']=function(ajax,response,status){if(!$('#boxes-box-form').size()||!$('#boxes-box-form').dialog('isOpen')){Drupal.ajax.prototype.commands.insert(ajax,response,status);$(response.selector).addClass('hasPopup');$('#boxes-box-form').dialog({modal:true,close:function(e){if(Drupal.wysiwygDetach&&$('.wysiwyg',this).val()){var item=$('.wysiwyg',this)[0],params=Drupal.settings.wysiwyg.triggers[item.id];Drupal.wysiwygDetach(this,params['format'+$(item).val()])};$(response.selector).removeClass('hasPopup').html(Drupal.t('Loading...'));$('.boxes-ajax.use-ajax-submit.form-submit[value="Cancel"]').click();$(this).dialog('destroy').remove()},open:function(ui,event){$(this).siblings('.ui-dialog-titlebar').children('.ui-dialog-titlebar-close').click(function(e){$('.boxes-ajax.use-ajax-submit.form-submit[value="Cancel"]').click()})},width:Math.min($(window).width()*.75,750),height:Math.min($(window).height()*.75,750),title:Drupal.t('Edit Box')})}else{response.selector='#boxes-box-form';Drupal.ajax.prototype.commands.insert(ajax,response,status)}};Drupal.behaviors.boxes={attach:function(context,settings){$('div.boxes-box-controls a:not(.boxes-processed)').addClass('boxes-processed').click(function(){if(this.href.indexOf('/admin/structure/block/manage/boxes/')!=-1)return;var box=$(this).parents('.boxes-box');if(box.is('.boxes-box-editing')){box.removeClass('boxes-box-editing').find('.box-editor').remove().end().find('.boxes-box-content').show()}else box.find('.boxes-box-content').hide().end().addClass('boxes-box-editing').prepend('<div class="box-editor"><div class="swirly"></div></div>');return false});Drupal.ajax.prototype.commands['preReplaceContextBlock']=function(ajax,response,status){data=response;Drupal.settings.boxes=Drupal.settings.boxes||{};var e=$('#'+data.id+' a.context-block:first').clone();Drupal.settings.boxes[data.id]=e};Drupal.ajax.prototype.commands['postReplaceContextBlock']=function(ajax,response,status){data=response;$('#'+data.id).append(Drupal.settings.boxes[data.id]);$('form.context-editor.context-editing').each(function(){var id=$(this).attr('id');if(Drupal.contextBlockEditor[id])Drupal.contextBlockEditor[id].initBlocks($('#'+data.id))})};$('.boxes-box-controls',context).each(function(){if($(this).parent().parent().hasClass("pane-content"))$(this).hide();if($(this).parents(".block").find(".block-configure").length>0){$(this).parents(".block").find(".block-configure").after($(this).find("li.edit"));$(this).parents(".block").find(".block-configure").detach()}});$('#boxes-box-form input').keydown(function(e){if(!e)e=window.event;if(e.keyCode==13){e.preventDefault();$('.boxes-ajax.use-ajax-submit.form-submit:first').click()}});$('.boxes-box-editing .box-editor #boxes-box-form').not('.processed').addClass('processed').dialog({modal:true,close:function(e){$(this).remove()},open:function(event,ui){$(this).siblings('.ui-dialog-titlebar').children('.ui-dialog-titlebar-close').hide()},width:Math.min($(window).width()*.75,750),height:Math.min($(window).height()*.75,750),title:Drupal.t('Configure Box')})}}})(jQuery);
/* Source and licensing information for the above line(s) can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/boxes/boxes.js. */
/* Source and licensing information for the line(s) below can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/context/plugins/context_reaction_block.js. */
(function($){Drupal.behaviors.contextReactionBlock={attach:function(context){$('form.context-editor:not(.context-block-processed)').addClass('context-block-processed').each(function(){var id=$(this).attr('id');Drupal.contextBlockEditor=Drupal.contextBlockEditor||{};$(this).bind('init.pageEditor',function(event){Drupal.contextBlockEditor[id]=new DrupalContextBlockEditor($(this))});$(this).bind('start.pageEditor',function(event,context){if(!context)context=$(this).data('defaultContext');Drupal.contextBlockEditor[id].editStart($(this),context)});$(this).bind('end.pageEditor',function(event){Drupal.contextBlockEditor[id].editFinish()})});$('#context-blockform:not(.processed)').each(function(){$(this).addClass('processed');Drupal.contextBlockForm=new DrupalContextBlockForm($(this));Drupal.contextBlockForm.setState()});$('#context-blockform a.remove:not(.processed)').each(function(){$(this).addClass('processed');$(this).click(function(){$(this).parents('tr').eq(0).remove();Drupal.contextBlockForm.setState();return false})});$('div.context-block-browser',context).nextAll('.form-item').hide()}};DrupalContextBlockForm=function(blockForm){this.state={};this.setState=function(){$('table.context-blockform-region',blockForm).each(function(){var region=$(this).attr('id').split('context-blockform-region-')[1],blocks=[];$('tr',$(this)).each(function(){var bid=$(this).attr('id'),weight=$(this).find('select,input').first().val();blocks.push({bid:bid,weight:weight})});Drupal.contextBlockForm.state[region]=blocks});$('form input.context-blockform-state').val(JSON.stringify(this.state));$('table.context-blockform-region tr').each(function(){var bid=$(this).attr('id');$('div.context-blockform-selector input[value='+bid+']').parents('div.form-item').eq(0).hide()});$('div.context-blockform-selector input').each(function(){var bid=$(this).val();if($('table.context-blockform-region tr#'+bid).size()===0)$(this).parents('div.form-item').eq(0).show()})};$('#ctools-export-ui-edit-item-form').submit(function(){Drupal.contextBlockForm.setState()});$.each(Drupal.settings.tableDrag,function(base){var table=$('#'+base+':not(.processed)',blockForm);if(table&&table.is('.context-blockform-region')){table.addClass('processed');table.bind('mouseup',function(event){Drupal.contextBlockForm.setState();return})}});$('td.blocks a',blockForm).each(function(){$(this).click(function(){var region=$(this).attr('href').split('#')[1],base="context-blockform-region-"+region,selected=$("div.context-blockform-selector input:checked");if(selected.size()>0){var weight_warn=false,min_weight_option=-10,max_weight_option=10,max_observed_weight=min_weight_option-1;$('table#'+base+' tr').each(function(){var weight_input_val=$(this).find('select,input').first().val();if(+weight_input_val>+max_observed_weight)max_observed_weight=weight_input_val});selected.each(function(){var block=document.createElement('tr'),text=$(this).parents('div.form-item').eq(0).hide().children('label').text(),select='<div class="form-item form-type-select"><select class="tabledrag-hide form-select">',i;weight_warn=true;var selected_weight=max_weight_option;if(max_weight_option>=(1+ +max_observed_weight)){selected_weight=++max_observed_weight;weight_warn=false};for(i=min_weight_option;i<=max_weight_option;++i){select+='<option';if(i==selected_weight)select+=' selected=selected';select+='>'+i+'</option>'};select+='</select></div>';$(block).attr('id',$(this).attr('value')).addClass('draggable');$(block).html("<td>"+text+"</td><td>"+select+"</td><td><a href='' class='remove'>X</a></td>");Drupal.tableDrag[base].makeDraggable(block);$('table#'+base).append(block);if($.cookie('Drupal.tableDrag.showWeight')==1){$('table#'+base).find('.tabledrag-hide').css('display','');$('table#'+base).find('.tabledrag-handle').css('display','none')}else{$('table#'+base).find('.tabledrag-hide').css('display','none');$('table#'+base).find('.tabledrag-handle').css('display','')};Drupal.attachBehaviors($('table#'+base));Drupal.contextBlockForm.setState();$(this).removeAttr('checked')});if(weight_warn)alert(Drupal.t('Desired block weight exceeds available weight options, please check weights for blocks before saving'))};return false})})};DrupalContextBlockEditor=function(editor){this.editor=editor;this.state={};this.blocks={};this.regions={};return this};DrupalContextBlockEditor.prototype={initBlocks:function(blocks){var self=this;this.blocks=blocks;blocks.each(function(){if($(this).hasClass('context-block-empty'))$(this).removeClass('context-block-hidden');$(this).addClass('draggable');$(this).prepend($('<a class="context-block-handle"></a>'));$(this).prepend($('<a class="context-block-remove"></a>').click(function(){$(this).parent('.block').eq(0).fadeOut('medium',function(){$(this).remove();self.updateBlocks()});return false}))})},initRegions:function(regions){this.regions=regions;var ref=this;$(regions).not('.context-ui-processed').each(function(index,el){$('.context-ui-add-link',el).click(function(e){ref.showBlockBrowser($(this).parent())}).addClass('context-ui-processed')});$('.context-block-browser').hide()},showBlockBrowser:function(region){var toggled=false,activeId=$('.context-editing',this.editor).attr('id').replace('-trigger',''),context=$('#'+activeId)[0];this.browser=$('.context-block-browser',context).addClass('active');if(!this.browser.has('input.filter').size()){var parent=$('.block-browser-sidebar .filter',this.browser),list=$('.blocks',this.browser);new Drupal.Filter(list,false,'.context-block-addable',parent)};this.browser.show().dialog({modal:true,close:function(){$(this).dialog('destroy');$('.category',this).show();$(this).hide().appendTo(context).removeClass('active')},height:(.8*$(window).height()),minHeight:400,minWidth:680,width:680});$('.context-block-browser-categories',this.browser).change(function(e){if($(this).val()==0){$('.category',self.browser).show()}else{$('.category',self.browser).hide();$('.category-'+$(this).val(),self.browser).show()}});if(this.addToRegion)$('.context-block-addable',this.browser).unbind('click.addToRegion');var self=this;this.addToRegion=function(e){var ui={item:$(this).clone(),sender:$(region)};$(this).parents('.context-block-browser.active').dialog('close');$(region).after(ui.item);self.addBlock(e,ui,this.editor,activeId.replace('context-editable-',''))};$('.context-block-addable',this.browser).bind('click.addToRegion',this.addToRegion)},updateBlocks:function(){var browser=$('div.context-block-browser');$('.block, .admin-block').each(function(){var bid=$(this).attr('id').split('block-')[1]});$('.context-block-item',browser).each(function(){var bid=$(this).attr('id').split('context-block-addable-')[1]});$(this.regions).each(function(){if($('.block:has(a.context-block)',this).size()>0){$(this).removeClass('context-block-region-empty')}else $(this).addClass('context-block-region-empty')})},updateRegion:function(event,ui,region,op){switch(op){case'over':$(region).removeClass('context-block-region-empty');break;case'out':if($('.draggable-placeholder',region).size()===1&&$('.block:has(a.context-block)',region).size()==0)$(region).addClass('context-block-region-empty');break}},scriptFix:function(event,ui,editor,context){if($('script',ui.item)){var placeholder=$(Drupal.settings.contextBlockEditor.scriptPlaceholder),label=$('div.handle label',ui.item).text();placeholder.children('strong').html(label);$('script',ui.item).parent().empty().append(placeholder)}},addBlock:function(event,ui,editor,context){var self=this;if(ui.item.is('.context-block-addable')){var bid=ui.item.attr('id').split('context-block-addable-')[1],params=Drupal.settings.contextBlockEditor.params;params.context_block=bid+','+context;if(!Drupal.settings.contextBlockEditor.block_tokens||!Drupal.settings.contextBlockEditor.block_tokens[bid]){alert(Drupal.t('An error occurred trying to retrieve block content. Please contact a site administer.'));return};params.context_token=Drupal.settings.contextBlockEditor.block_tokens[bid];var blockLoading=$('<div class="context-block-item context-block-loading"><span class="icon"></span></div>');ui.item.addClass('context-block-added');ui.item.after(blockLoading);$.getJSON(Drupal.settings.contextBlockEditor.path,params,function(data){if(data.status){var newBlock=$(data.block);if($('script',newBlock))$('script',newBlock).remove();blockLoading.fadeOut(function(){$(this).replaceWith(newBlock);self.initBlocks(newBlock);self.updateBlocks();Drupal.attachBehaviors(newBlock)})}else blockLoading.fadeOut(function(){$(this).remove()})})}else if(ui.item.is(':has(a.context-block)'))self.updateBlocks()},setState:function(){var self=this;$(this.regions).each(function(){var region=$('.context-block-region',this).attr('id').split('context-block-region-')[1],blocks=[];$('a.context-block',$(this)).each(function(){if($(this).attr('class').indexOf('edit-')!=-1){var bid=$(this).attr('id').split('context-block-')[1],context=$(this).attr('class').split('edit-')[1].split(' ')[0];context=context?context:0;var block={bid:bid,context:context};blocks.push(block)}});self.state[region]=blocks});$('input.context-block-editor-state',this.editor).val(JSON.stringify(this.state))},disableTextSelect:function(){if($.browser.safari){$('.block:has(a.context-block):not(:has(input,textarea))').css('WebkitUserSelect','none')}else if($.browser.mozilla){$('.block:has(a.context-block):not(:has(input,textarea))').css('MozUserSelect','none')}else if($.browser.msie){$('.block:has(a.context-block):not(:has(input,textarea))').bind('selectstart.contextBlockEditor',function(){return false})}else $(this).bind('mousedown.contextBlockEditor',function(){return false})},enableTextSelect:function(){if($.browser.safari){$('*').css('WebkitUserSelect','')}else if($.browser.mozilla){$('*').css('MozUserSelect','')}else if($.browser.msie){$('*').unbind('selectstart.contextBlockEditor')}else $(this).unbind('mousedown.contextBlockEditor')},editStart:function(editor,context){var self=this;$(document.body).addClass('context-editing');this.editor.addClass('context-editing');this.disableTextSelect();this.initBlocks($('.block:has(a.context-block.edit-'+context+')'));this.initRegions($('.context-block-region').parent());this.updateBlocks();$('a.context_ui_dialog-stop').hide();$('.editing-context-label').remove();var label=$('#context-editable-trigger-'+context+' .label').text();label=Drupal.t('Now Editing: ')+label;editor.parent().parent().prepend('<div class="editing-context-label">'+label+'</div>');$(this.regions).each(function(){var region=$(this),params={revert:true,dropOnEmpty:true,placeholder:'draggable-placeholder',forcePlaceholderSize:true,items:'> .block:has(a.context-block.editable)',handle:'a.context-block-handle',start:function(event,ui){self.scriptFix(event,ui,editor,context)},stop:function(event,ui){self.addBlock(event,ui,editor,context)},receive:function(event,ui){self.addBlock(event,ui,editor,context)},over:function(event,ui){self.updateRegion(event,ui,region,'over')},out:function(event,ui){self.updateRegion(event,ui,region,'out')},cursorAt:{left:300,top:0}};region.sortable(params)});$(this.regions).each(function(){$(this).sortable('option','connectWith',['.ui-sortable'])});if($.ui.version==='1.6'&&$.browser.safari)$.browser.mozilla=true},editFinish:function(){this.editor.removeClass('context-editing');this.enableTextSelect();$('.editing-context-label').remove();$(this.blocks).each(function(){$('a.context-block-handle, a.context-block-remove',this).remove();if($(this).hasClass('context-block-empty'))$(this).addClass('context-block-hidden');$(this).removeClass('draggable')});$('a.context_ui_dialog-stop').show();this.regions.sortable('destroy');this.setState();if($.ui.version==='1.6'&&$.browser.safari)$.browser.mozilla=false}}})(jQuery);
/* Source and licensing information for the above line(s) can be found at http://godiscoverandplay.com/profiles/openpublish/modules/contrib/context/plugins/context_reaction_block.js. */
